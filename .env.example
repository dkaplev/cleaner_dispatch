# Copy this file to .env and fill in real values. Never commit .env.

# Database: Supabase → Connect → Connection string → use "Session pooler" (IPv4 compatible).
# Direct connection is often IPv6-only and can fail with "Can't reach database server".
# Format: postgresql://postgres.[PROJECT_REF]:[PASSWORD]@aws-0-[region].pooler.supabase.com:5432/postgres
# If Prisma migrate fails with P1011 "bad certificate format", append: ?sslmode=require
# If you use transaction pooler (port 6543), also add: &pgbouncer=true
# Example: .../postgres?sslmode=require
# The app adds uselibpqcompat=true automatically for Supabase/Vercel TLS (avoids "self-signed certificate" errors).
DATABASE_URL=

# Optional: only if we use Supabase Auth or Supabase JS client later (not needed for Prisma)
# NEXT_PUBLIC_SUPABASE_URL=https://xxxx.supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=

# NextAuth (landlord login). Generate secret: npx auth secret (or openssl rand -base64 32)
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=

# Telegram bot (dispatch to cleaners). Create via @BotFather on Telegram, then paste the token here.
# Test: Dashboard → "Telegram test" → enter your chat ID → Send test message.
TELEGRAM_BOT_TOKEN=
# Bot username (no @) for cleaner linking links, e.g. MyCleanerDispatchBot. Used in Edit cleaner → "Link Telegram".
# Webhook (required for "Link Telegram" to work): Telegram must POST to your app when someone messages the bot.
#   - Production: set once: https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://YOUR_DOMAIN/api/telegram/webhook
#   - Local dev: Telegram cannot reach localhost; linking will work only after deploy (or use ngrok to test).
# REMINDER (production): After deploying, set webhook with the production URL, then test "Link Telegram" with a real cleaner (send link → they tap Start → confirm message + DB update).
TELEGRAM_BOT_USERNAME=

# Dispatch: minutes a cleaner has to accept/decline before the offer is routed to the next cleaner. Default 10.
RESPONSE_MINUTES=10

# Required for dispatch timeout cron. Generate a secret (e.g. openssl rand -base64 32). Cron must send Authorization: Bearer <CRON_SECRET> or ?secret=<CRON_SECRET> when calling /api/cron/dispatch-timeout.
CRON_SECRET=

# Photo uploads: when BLOB_READ_WRITE_TOKEN is set, photos go to Vercel Blob (persistent). No UPLOAD_DIR needed.
# When not using Blob: local default ./uploads; on Vercel set UPLOAD_DIR=/tmp (ephemeral). See Deploy_checklist.md §3.
# BLOB_READ_WRITE_TOKEN=   # from Vercel Blob store (recommended on Vercel)
# UPLOAD_DIR=/tmp
# Optional: secret for signed upload links (defaults to NEXTAUTH_SECRET if not set).
# UPLOAD_TOKEN_SECRET=

# Optional: days to keep job photos after job is completed and reviewed (default: 90). After that, cron deletes files and DB rows.
# RETENTION_DAYS=90
# Cleanup cron: GET https://YOUR_DOMAIN/api/cron/cleanup-old-media (same CRON_SECRET as dispatch-timeout). Run daily.
